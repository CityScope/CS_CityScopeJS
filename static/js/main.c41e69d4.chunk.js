/*! For license information please see main.c41e69d4.chunk.js.LICENSE.txt */
(this.webpackJsonpcityscopejs=this.webpackJsonpcityscopejs||[]).push([[0],{426:function(e,t){},44:function(e){e.exports=JSON.parse('{"docsURL":"https://raw.githubusercontent.com/CityScope/CS_cityscopeJS/master/docs/","cityIO":{"baseURL":"https://cityio.media.mit.edu/api/table/","interval":500,"cityIOmodules":[{"name":"header","expectUpdate":false},{"name":"GEOGRID","expectUpdate":false},{"name":"ABM2","expectUpdate":true},{"name":"grid","expectUpdate":false},{"name":"access","expectUpdate":true},{"name":"GEOGRIDDATA","expectUpdate":false},{"name":"indicators","expectUpdate":true}]},"menu":{"toggles":{"GRID":{"displayName":"Interactive Grid","showOnInit":true,"requireModule":"GEOGRID"},"ABM":{"displayName":"Mobility Simulation","showOnInit":false,"requireModule":"ABM2"},"AGGREGATED_TRIPS":{"displayName":"Aggregated Trips","showOnInit":false,"requireModule":"ABM2"},"ACCESS":{"displayName":"Accessibility Analysis","showOnInit":false,"requireModule":"access"},"ROTATE":{"displayName":"Rotate Camera","showOnInit":false,"requireModule":false},"SHADOWS":{"displayName":"Toggle Shadows","showOnInit":true,"requireModule":"GEOGRID"}}},"map":{"mapStyle":{"sat":"mapbox://styles/relnox/cjs9rb33k2pix1fo833uweyjd?fresh=true","blue":"mapbox://styles/relnox/ck0h5xn701bpr1dqs3he2lecq?fresh=true"},"layers":{"ABM":{"startSimHour":0,"endSimHour":86400,"currentSimHour":43200,"animationSpeed":20},"heatmap":{"colors":[[255,0,130],[0,150,255]]}},"initialViewState":{"zoom":17,"pitch":0,"bearing":0}}}')},603:function(e,t,a){e.exports=a(709)},614:function(e,t){},67:function(e){e.exports=JSON.parse('{"map":{"mapStyle":{"sat":"mapbox://styles/relnox/cjs9rb33k2pix1fo833uweyjd?fresh=true","dark":"mapbox://styles/relnox/cjl58dpkq2jjp2rmzyrdvfsds?fresh=true","blue":"mapbox://styles/relnox/ck0h5xn701bpr1dqs3he2lecq?fresh=true"}},"GEOGRIDDATA":{"color":[0,0,0],"height":0,"id":0,"interactive":"Web","name":"name"},"GEOGRID":{"features":[],"properties":{"geogrid_to_tui_mapping":{},"header":{"cellSize":50,"latitude":42.3664655,"longitude":-71.0854323,"tz":-5,"ncols":20,"nrows":20,"rotation":0,"projection":"+proj=lcc +lat_1=42.68333333333333 +lat_2=41.71666666666667 +lat_0=41 +lon_0=-71.5 +x_0=200000 +y_0=750000 +ellps=GRS80 +datum=NAD83 +units=m +no_def"},"types":{"Institutional":{"LBCS":[{"proportion":0.3,"use":{"6700":1}},{"proportion":0.7,"use":{"2310":0.3,"4100":0.7}}],"NAICS":[{"proportion":0.3,"use":{"7121":1}},{"proportion":0.7,"use":{"6111":0.3,"6113":0.1,"6115":0.1,"6116":0.2,"8133":0.15,"8134":0.15}}],"interactive":"Web","color":"#B32745","height":4,"sqm_pperson":400},"Office":{"LBCS":[{"proportion":1,"use":{"2310":1}}],"NAICS":[{"proportion":1,"use":{"5400":1}}],"interactive":"Web","color":"#FF5277","height":10,"sqm_pperson":20},"Park":{"LBCS":[{"proportion":1,"use":{"7240":1}}],"NAICS":null,"interactive":"Web","color":"#38C9FF","sqm_pperson":1},"Road":{"LBCS":[{"proportion":1,"use":{"5210":1}}],"NAICS":null,"interactive":"Web","color":"#308FB3","height":1,"sqm_pperson":4},"Residential":{"LBCS":[{"proportion":1,"use":{"1100":1}}],"NAICS":null,"interactive":"Web","color":"#FFFF33","height":4,"sqm_pperson":90},"Retail":{"LBCS":[{"proportion":1,"use":{"2100":0.6,"2200":0.4}}],"NAICS":[{"proportion":1,"use":{"4451":0.02,"4453":0.02,"7224":0.26,"7225":0.7}}],"interactive":"Web","color":"#FF835E","height":4,"sqm_pperson":150},"Campus":{"LBCS":[{"proportion":1,"use":{"2310":1}}],"NAICS":[{"proportion":1,"use":{"3336":0.5,"5414":0.2,"5415":0.1,"5417":0.2}}],"interactive":"Web","color":"#A2FF91","height":10,"sqm_pperson":50},"Industrial":{"LBCS":[{"proportion":1,"use":{"3110":1}}],"NAICS":[{"proportion":1,"use":{"4841":0.2,"5617":0.3,"5619":0.3,"8111":0.2}}],"interactive":"Web","color":"#E83FB8","height":4,"sqm_pperson":60},"Low Income housing":{"LBCS":[{"proportion":0.1,"use":{"2200":1}},{"proportion":0.75,"use":{"2310":1}},{"proportion":0.15,"use":{"1200":1}}],"NAICS":[{"proportion":0.1,"use":{"7224":0.5,"7225":0.5}},{"proportion":0.75,"use":{"5414":0.4,"5415":0.2,"5417":0.4}},{"proportion":0.15,"use":{"7211":1}}],"interactive":"Web","color":"#E945FF","height":20,"sqm_pperson":50},"Residential Low Density":{"LBCS":[{"proportion":1,"use":{"1100":1}}],"NAICS":null,"interactive":"Web","color":"#7FB34B","height":4,"sqm_pperson":320}}},"type":"FeatureCollection"}}')},708:function(e,t,a){},709:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(35),i=a.n(o),l=a(134),c=a(112),u=a(40),s=a(740),m=a(486),p=a(487),d=Object(m.a)((function(){return Object(p.a)({"@global":{"*":{boxSizing:"border-box",margin:0,padding:0},html:{"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",height:"100%",width:"100%"},body:{backgroundColor:"#18191a",height:"100%",width:"100%"},a:{textDecoration:"none"},"#root":{height:"100%",width:"100%"}}})})),f=function(){return d(),null},h=a(206),E=a(54),g={fontFamily:'"Roboto Mono", sans-serif',fontSize:14,fontWeightLight:100,fontWeightRegular:500,fontWeightMedium:700,h1:{fontWeight:700,fontSize:45,letterSpacing:"-1px"},h2:{fontWeight:800,fontSize:29,letterSpacing:"-0.24px"},h3:{fontWeight:700,fontSize:24,letterSpacing:"-0.06px"},h4:{fontWeight:500,fontSize:20,letterSpacing:"-0.06px"},h5:{fontWeight:500,fontSize:16,letterSpacing:"-0.05px"},h6:{fontWeight:500,fontSize:14,letterSpacing:"-0.05px"},overline:{fontWeight:500}},b=Object(h.a)({zIndex:{appBar:1500},palette:{background:{default:"#ff5278",paper:"#18191a",dark:"#ff5278"},primary:{main:"#FFF",light:"#ff5278"},secondary:{main:"#ff5278"},text:{primary:E.colors.grey[100],secondary:"#ff5278"}},typography:g,shape:{borderRadius:20},overrides:{MuiListItem:{root:{"&$selected":{backgroundColor:"#18191a",boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)","&:hover":{backgroundColor:"#ff5278"}}},button:{"&:hover":{backgroundColor:"#ff5278"}}},MuiAppBar:{colorPrimary:{backgroundColor:"#18191a",color:"#FFF"}},MuiDivider:{root:{backgroundColor:"#FFF",opacity:.1}},MuiCard:{root:{boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)"}},MuiButton:{root:{boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)","&:hover":{boxShadow:"12px 12px 16px 0  #000,-2px -2px 16px 0  #ff5278"},width:"100%"}}}}),O=a(32),v=a(338),S=a.n(v),y=a(398),j=a(719),C=a(743),I=a(744),D=a(753),T=a(127),x=a(115),A=a(761),R=a(762),N=a(763),_=a(226),w=a(4),M=a(720),G=a(488),L=Object(m.a)((function(e){return{item:{display:"flex",paddingTop:0,paddingBottom:0},button:{color:e.palette.text.main,fontWeight:e.typography.fontWeightMedium,justifyContent:"flex-start",letterSpacing:0,padding:"10px 8px",textTransform:"none",width:"100%"},icon:{marginRight:e.spacing(1)},title:{marginRight:"auto"},active:{color:e.palette.text.secondary,"& $title":{fontWeight:e.typography.fontWeightBold},"& $icon":{color:e.palette.text.secondary}}}})),k=function(e){var t=e.className,a=e.href,n=e.icon,o=e.title,i=Object(_.a)(e,["className","href","icon","title"]),c=L();return r.a.createElement(M.a,Object.assign({className:Object(w.a)(c.item,t),disableGutters:!0},i),r.a.createElement(G.a,{activeClassName:c.active,className:c.button,component:l.c,to:a},n&&r.a.createElement(n,{className:c.icon,size:"20"}),r.a.createElement("span",{className:c.title},o)))},F=[{href:"/home",icon:A.a,title:"Home"},{href:"/cityscopejs",icon:R.a,title:"CityScopeJS"},{href:"/editor",icon:N.a,title:"Grid Editor"}],P=Object(m.a)((function(){return{mobileDrawer:{width:"30vw",top:48,height:"calc(100% - 48px)",boxShadow:"22px 22px 22px 0 rgba(0,0,0)"}}})),B=function(e){var t=e.onMobileClose,a=e.openMobile,o=P(),i=Object(u.f)();Object(n.useEffect)((function(){a&&t&&t()}),[i.pathname]);var l=r.a.createElement(y.a,{height:"100%",display:"flex",flexDirection:"column",p:3},r.a.createElement(j.a,null,F.map((function(e){return r.a.createElement(k,{style:{padding:"2vh"},href:e.href,key:e.title,title:e.title,icon:e.icon})}))),r.a.createElement(y.a,{flexGrow:1}),r.a.createElement(C.a,{elevation:5,p:2},r.a.createElement(I.a,{position:"bottom"},r.a.createElement(D.a,{href:"http://github.com/CityScope/CS_cityscopeJS/",color:"default",size:"small"},r.a.createElement(S.a,null)),r.a.createElement(y.a,{p:2}),r.a.createElement(T.a,{align:"left",variant:"h5"},"MIT CityScope"),r.a.createElement(T.a,{align:"left",variant:"caption"},(new Date).getFullYear()))));return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{anchor:"left",classes:{paper:o.mobileDrawer},onClose:t,open:a,elevation:10,variant:"persistent"},l))};B.defaultProps={onMobileClose:function(){},openMobile:!1};var W=B,z=a(742),U=a(502),V=a(410),J=a(547),Y=a.n(J),q=Object(m.a)((function(){return{root:{}}})),H=function(e){var t=e.className,a=e.onMobileNavOpen,n=Object(_.a)(e,["className","onMobileNavOpen"]),o=q();return r.a.createElement(z.a,Object.assign({className:Object(w.a)(o.root,t),elevation:5},n),r.a.createElement(U.a,{variant:"dense"},r.a.createElement(V.a,{color:"inherit",onClick:a},r.a.createElement(Y.a,null)),r.a.createElement(l.b,{to:"/"},r.a.createElement(T.a,{className:o.name,color:"textPrimary",variant:"h5"},"MIT CityScope"))))},X=Object(m.a)((function(e){return{root:{backgroundColor:e.palette.background,display:"flex",height:"100%",overflow:"hidden",width:"100%"},content:{paddingTop:48,flex:"1 1 auto",height:"100vh",overflow:"auto"}}})),K=function(){var e=X(),t=Object(n.useState)(!0),a=Object(O.a)(t,2),o=a[0],i=a[1];return r.a.createElement("div",{className:e.root},r.a.createElement(W,{openMobile:!o}),r.a.createElement(H,{onMobileNavOpen:function(){return i(!o)}}),r.a.createElement("div",{className:e.content},r.a.createElement(u.b,null)))},Q=a(745),$=a(548),Z=Object(n.forwardRef)((function(e,t){var a=e.children,n=e.title,o=void 0===n?"":n,i=Object(_.a)(e,["children","title"]);return r.a.createElement("div",Object.assign({ref:t},i),r.a.createElement($.a,null,r.a.createElement("title",null,"CityScopeJS ",">"," ",o)),a)})),ee=Object(m.a)((function(e){return{root:{backgroundColor:e.palette.background,height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)},image:{marginTop:50,display:"inline-block",maxWidth:"100%",width:560}}})),te=function(){var e=ee();return r.a.createElement(Z,{className:e.root,title:"404"},r.a.createElement(y.a,{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center"},r.a.createElement(Q.a,{maxWidth:"md"},r.a.createElement(T.a,{align:"center",color:"textPrimary",variant:"h1"},"404"),r.a.createElement(T.a,{align:"center",color:"textPrimary",variant:"h5"},"The page you are looking for isn\u2019t here"))))},ae=a(19),ne=a(339),re=a(340),oe=a(359),ie=a(357);function le(e){if(!e.mousePos)return null;var t=e.mousePos,a=e.selectedType,n=e.divSize,o="rgba("+a.color[0]+","+a.color[1]+","+a.color[2]+",0.6)",i=t.clientX-n/2,l=t.clientY-n/2;return r.a.createElement("div",{style:{border:"2px solid",backgroundColor:e.mouseDown?o:"rgba(0,0,0,0)",borderColor:a.color,color:a.color,borderRadius:"15%",position:"fixed",zIndex:1,pointerEvents:"none",width:n,height:n,left:i,top:l}},r.a.createElement("div",{style:{position:"relative",left:n+10,fontSize:"0.5em"}},a.name))}var ce=a(26),ue=a(353),se=a(773),me=(a(508),a(769)),pe=a(67);function de(e){return{type:"GET_CITYIO_DATA",data:e}}function fe(e){return{type:"LISTEN_TO_ABM_SLIDERS",data:e}}function he(e){return{type:"LISTEN_TO_EDIT_MENU",data:e}}function Ee(e){return{type:"SET_READY_STATE",data:e}}function ge(e){return{type:"SET_LOADING_STATE",data:e}}function be(e){return{type:"SET_SCENARIO_NAMES",data:e}}function Oe(e){return{type:"ADD_LOADING_MODULES",data:e}}function ve(e){return{type:"REMOVE_LOADING_MODULES",data:e}}function Se(e){return{type:"LISTEN_TO_GRID_CREATOR",data:e}}function ye(e){return{type:"LISTEN_TO_ROW_EDIT",data:e}}function je(e){return{type:"LISTEN_TO_BASE_MAP_CENTER",data:e}}var Ce=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},Ie=function(e){Object(oe.a)(a,e);var t=Object(ie.a)(a);function a(e){var n;return Object(ne.a)(this,a),(n=t.call(this,e))._toggleOrthoView=function(e){e.orthographic=!!n.props.menu.includes("RESET_VIEW")},n._onViewStateChange=function(e){var t=e.viewState;n.setState({viewState:t})},n.componentDidUpdate=function(e){n.props.mapCenter!==e.mapCenter&&n.setState({viewState:Object(ae.a)(Object(ae.a)({},n.state.viewState),{},{latitude:n.props.mapCenter.latCenter,longitude:n.props.mapCenter.lonCenter,pitch:0,bearing:0,orthographic:!1})})},n._mulipleObjPicked=function(e){var t=n.state.pickingRadius,a=e.x-t/2,r=e.y-t/2;return n.deckGL.pickObjects({x:a,y:r,width:t,height:t})},n._handleGridcellEditing=function(e){if(n.props.selectedType){var t=n.props.selectedType,a=t.height,r=t.name,o=t.color,i=t.interactive,l=n._mulipleObjPicked(e);l.forEach((function(e){var t=e.object.properties;t.color=Ce(o),t.height=parseInt(a),t.name=r,"No"!==i?t.interactive=i:delete t.interactive})),n.setState({selectedCellsState:l})}},n._renderSelectionTarget=function(){return n.props.selectedType&&r.a.createElement(le,{mousePos:n.state.mousePos,selectedType:n.props.selectedType,divSize:n.state.pickingRadius,mouseDown:n.state.mouseDown})},n._handleKeyUp=function(){n.setState({keyDownState:null})},n._handleKeyDown=function(e){n.setState({keyDownState:e.nativeEvent.key})},n.state={selectedType:null,draggingWhileEditing:!1,selectedCellsState:null,pickingRadius:40,viewState:pe.map.initialViewState},n.dirLightSettings={timestamp:Date.UTC(2019,7,1,12),color:[255,255,255],intensity:1,_shadow:!0},n}return Object(re.a)(a,[{key:"componentDidMount",value:function(){this._rightClickViewRotate(),this._setViewStateToTableHeader()}},{key:"_setViewStateToTableHeader",value:function(){this.setState({viewState:Object(ae.a)(Object(ae.a)({},this.state.viewState),{},{latitude:pe.GEOGRID.properties.header.latitude,longitude:pe.GEOGRID.properties.header.longitude,zoom:15,pitch:0,bearing:0,orthographic:!0})})}},{key:"_rightClickViewRotate",value:function(){document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))}},{key:"_renderLayers",value:function(){var e=this,t=[];return t.push(new me.a({id:"GRID",opacity:.5,stroked:!1,filled:!0,wireframe:!0,data:this.props.createdGrid,visible:!0,pickable:!0,extruded:!0,lineWidthScale:1,lineWidthMinPixels:1,getElevation:function(e){return e.properties.height},getFillColor:function(e){return e.properties.color},onClick:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e._handleGridcellEditing(t)},onDrag:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e._handleGridcellEditing(t)},onDragStart:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e.setState({draggingWhileEditing:!0})},onDragEnd:function(){e.setState({draggingWhileEditing:!1})},updateTriggers:{getFillColor:this.state.selectedCellsState,getElevation:this.state.selectedCellsState},transitions:{getFillColor:500,getElevation:500}})),t}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"baseMap",onKeyDown:this._handleKeyDown,onKeyUp:this._handleKeyUp,onMouseMove:function(t){return e.setState({mousePos:t.nativeEvent})},onMouseUp:function(){return e.setState({mouseDown:!1})},onMouseDown:function(){return e.setState({mouseDown:!0})}},this._renderSelectionTarget(),r.a.createElement(se.a,{ref:function(t){e.deckGL=t&&t.deck},viewState:this.state.viewState,onViewStateChange:this._onViewStateChange,layers:this._renderLayers(),controller:{touchZoom:!0,touchRotate:!0,dragPan:!this.state.draggingWhileEditing,dragRotate:!this.state.draggingWhileEditing,keyboard:!1}},r.a.createElement(ue.a,{dragRotate:!0,reuseMaps:!0,mapboxApiAccessToken:"pk.eyJ1IjoicmVsbm94IiwiYSI6ImNqd2VwOTNtYjExaHkzeXBzYm1xc3E3dzQifQ.X8r8nj4-baZXSsFgctQMsg",mapStyle:pe.map.mapStyle.sat,preventStyleDiffing:!0})))}}]),a}(n.Component),De={listenToBaseMapCenter:je},Te=Object(ce.b)((function(e){return{selectedType:e.ROW_EDIT,mapCenter:e.BASE_MAP_CENTER,createdGrid:e.GRID_CREATED}}),De)(Ie),xe=a(84),Ae=a(418),Re=a.n(Ae),Ne=a(754);function _e(){var e=r.a.useState({columns:[{title:"Type",field:"name"},{title:"Description",field:"description"},{title:"Height",field:"height",type:"numeric"},{title:"Interactive",field:"interactive",lookup:{No:"No",Web:"Web",TUI:"TUI"}},{title:"Color",field:"color",type:"string"},{title:"LBCS",field:"LBCS",type:"string"},{title:"NAICS",field:"NAICS",type:"string"}],data:function(e){var t=[];return Object.keys(e).forEach((function(a){t.push({name:a,description:"description for: "+a,color:e[a].color,height:e[a].height?e[a].height:0,LBCS:e[a].LBCS?JSON.stringify(e[a].LBCS):null,NAICS:e[a].NAICS?JSON.stringify(e[a].NAICS):null,interactive:e[a].interactive})})),t}(pe.GEOGRID.properties.types)}),t=Object(O.a)(e,2),a=t[0],o=t[1],i=Object(ce.c)(),l=Object(n.useState)(null),c=Object(O.a)(l,2),u=c[0],s=c[1],m=Object(n.useState)(null),p=Object(O.a)(m,2),d=p[0],f=p[1];return Object(n.useEffect)((function(){i({type:"LISTEN_TO_TYPES_LIST",data:a.data})})),r.a.createElement(Ne.a,{container:!0},r.a.createElement(Ne.a,{item:!0,xs:12,s:12,m:12,l:12,xl:12},r.a.createElement(Re.a,{title:r.a.createElement(T.a,{variant:"h2"},"Types Editor"),columns:a.columns,data:a.data,options:{paging:!1,search:!1,selection:!1,rowStyle:function(e){return{fontFamily:"Roboto Mono",fontSize:12,backgroundColor:u===e.tableData.id?d:null}}},onRowClick:function(e,t){s(t.tableData.id),f(t.color),i(ye(t))},editable:{onRowAdd:function(e){return new Promise((function(t){setTimeout((function(){t(),o((function(t){var a=Object(xe.a)(t.data);return a.push(e),Object(ae.a)(Object(ae.a)({},t),{},{data:a})}))}),500)}))},onRowUpdate:function(e,t){return new Promise((function(a){setTimeout((function(){a(),t&&o((function(a){var n=Object(xe.a)(a.data);return n[n.indexOf(t)]=e,Object(ae.a)(Object(ae.a)({},a),{},{data:n})})),i(ye(e))}),500)}))},onRowDelete:function(e){return new Promise((function(t){setTimeout((function(){t(),o((function(t){var a=Object(xe.a)(t.data);return a.splice(a.indexOf(e),1),Object(ae.a)(Object(ae.a)({},t),{},{data:a})})),i(Se(null))}),500)}))}}})))}var we=a(220),Me=a(504),Ge=a(559),Le=a.n(Ge),ke=a(277);function Fe(e){return e*Math.PI/180}function Pe(e){return 180*e/Math.PI}var Be=function(e){var t=Object.keys(e);return e[t[t.length*Math.random()<<0]]};function We(e){var t=Object(ce.c)(),a=Object(ce.d)((function(e){return e})),n=function(){var n=function(e,t){for(var a=parseFloat(e.longitude),n=parseFloat(e.latitude),r=parseFloat(e.rotation),o=e.projection,i=parseFloat(e.cellSize),l=parseFloat(e.nrows),c=parseFloat(e.ncols),u=ke.a.defs("EPSG:4326"),s={lon:a,lat:n},m=(90-r+360)%360,p=i*c/6371e3,d=Fe(s.lat),f=Fe(s.lon),h=Fe(m),E=Math.asin(Math.sin(d)*Math.cos(p)+Math.cos(d)*Math.sin(p)*Math.cos(h)),g={lon:Pe(f+Math.atan2(Math.sin(h)*Math.sin(p)*Math.cos(d),Math.cos(p)-Math.sin(d)*Math.sin(E))),lat:Pe(E)},b=Object(ke.a)(u,o,[s.lon,s.lat]),O=Object(ke.a)(u,o,[g.lon,g.lat]),v=(O[1]-b[1])/(O[0]-b[0]),S=Math.atan(v),y=Math.cos(S),j=Math.sin(S),C=[],I=[],D=0;D<l;D++)for(var T=0;T<c;T++)C.push(T*i),I.push(-D*i);for(var x=[],A=[],R=0;R<C.length;R++)x.push(C[R]*y-I[R]*j),A.push(C[R]*j+I[R]*y);for(var N=[],_=[],w=0;w<x.length;w++)N.push(b[0]+x[w]),_.push(b[1]+A[w]);for(var M=N[1]-N[0],G=_[1]-_[0],L=N[c]-N[0],k=_[c]-_[0],F=[],P={type:"FeatureCollection",features:[]},B=t,W=0;W<N.length;W++){for(var z=Be(B),U={type:"Feature",geometry:{type:"Polygon",coordinates:null},properties:{color:Ce(z.color),height:z.height,name:z.name,interactive:z.interactive,id:W}},V=[[N[W],_[W]],[N[W]+L,_[W]+k],[N[W]+L+M,_[W]+k+G],[N[W]+M,_[W]+G],[N[W],_[W]]],J=[],Y=0;Y<5;Y++){var q=Object(ke.a)(o,u,V[Y]);J.push(q)}U.geometry.coordinates=[J],F.push(U)}return P.features=F,P}(e.gridProps,a.TYPES_LIST);t(Se(n))};return r.a.createElement(G.a,{onClick:function(){n()},variant:"outlined",color:"default",startIcon:r.a.createElement(Le.a,null)},"Create Grid")}var ze=a(224),Ue=a.n(ze),Ve=a(560),Je=a.n(Ve),Ye=a(76),qe=a.n(Ye),He=a(755),Xe=function(e,t,a,n){var r=e,o={};return t.forEach((function(e){o[e.name]=e,o[e.name].LBCS="string"==typeof e.LBCS?JSON.parse(e.LBCS):e.LBCS,o[e.name].NAICS="string"==typeof e.NAICS?JSON.parse(e.NAICS):e.NAICS})),r.properties.types=o,r.properties.header=n,r.properties.header.longitude=parseFloat(r.properties.header.longitude),r.properties.header.latitude=parseFloat(r.properties.header.latitude),r.properties.header.rotation=parseFloat(r.properties.header.rotation),r.properties.header.nrows=parseFloat(r.properties.header.nrows),r.properties.header.ncols=parseFloat(r.properties.header.ncols),r.properties.header.cellSize=parseFloat(r.properties.header.cellSize),r.features=a,r};function Ke(e){var t=r.a.useState(null),a=Object(O.a)(t,2),n=a[0],o=a[1],i=Object(ce.d)((function(e){return e})),l=i.GRID_CREATED,c=function(){var t=pe.GEOGRID,a=i.TYPES_LIST,n=i.GRID_CREATED.features,l=e.gridProps,c=Xe(t,a,n,l),u=function(e){var t=[];return e.forEach((function(e){t.push(e.properties)})),t}(n),s=c.properties.header.tableName.toLowerCase(),m={geoGridURL:"https://cityio.media.mit.edu/api/table/update/"+s+"/GEOGRID",geoGridDataURL:"https://cityio.media.mit.edu/api/table/update/"+s+"/GEOGRIDDATA"},p=function(e,t){return{method:"post",url:e,data:t,headers:{"Content-Type":"application/json",Accept:"application/json"}}};qe()(p(m.geoGridURL,c)).then((function(e){o(function(e,t){var a="https://cityscope.media.mit.edu/CS_cityscopeJS/?cityscope="+t;return r.a.createElement(T.a,{color:"textPrimary",variant:"caption"},"CityIO is ",e.data.status,". Grid deployed to"," ",r.a.createElement(He.a,{color:"textSecondary",href:a},a))}(e,s))})).then((function(){qe()(p(m.geoGridDataURL,{})),console.log("removed GEOGRIDDATA")})).then((function(){qe()(p(m.geoGridDataURL,u)),console.log("mirrored GEOGRID to GEOGRIDDATA")})).catch((function(e){console.log("ERROR:",e)}))};return r.a.createElement(r.a.Fragment,null,l&&r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{onClick:function(){c()},variant:"outlined",color:"default",startIcon:r.a.createElement(Ue.a,null)},"Commit Grid to cityIO"),r.a.createElement(G.a,{onClick:function(){!function(){var t=pe.GEOGRID,a=i.TYPES_LIST,n=i.GRID_CREATED.features,r=e.gridProps,o=Xe(t,a,n,r),l="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o)),c=document.createElement("a");c.setAttribute("href",l),c.setAttribute("download","grid.json"),document.body.appendChild(c),c.click(),c.remove()}()},variant:"outlined",color:"default",startIcon:r.a.createElement(Je.a,null)},"Download JSON"),r.a.createElement("div",{style:{width:"100%"}}," ",n)))}var Qe=a(561),$e=a.n(Qe);function Ze(e){var t=Object(ce.c)();return r.a.createElement(G.a,{onClick:function(){t(je({latCenter:parseFloat(e.mapCenter[0]),lonCenter:parseFloat(e.mapCenter[1])}))},variant:"outlined",color:"default",startIcon:r.a.createElement($e.a,null),style:{fontSize:"12px"}},"Center Map")}function et(){var e=Object(m.a)((function(e){return{notchedOutline:{borderWidth:"1px",borderColor:e.palette.text.secondary},root:{"& .MuiTextField-root":{margin:e.spacing(1),flexWrap:"wrap"},"& > *":{margin:e.spacing(1)}}}})),t=r.a.useState({tableName:"CityScopeJS",latitude:pe.GEOGRID.properties.header.latitude,longitude:pe.GEOGRID.properties.header.longitude,tz:pe.GEOGRID.properties.header.tz,nrows:pe.GEOGRID.properties.header.nrows,ncols:pe.GEOGRID.properties.header.nrows,rotation:pe.GEOGRID.properties.header.rotation,cellSize:pe.GEOGRID.properties.header.cellSize,projection:pe.GEOGRID.properties.header.projection}),a=Object(O.a)(t,2),n=a[0],o=a[1],i=function(e){var t=e.target,a=t.id,r=t.value;o(Object(ae.a)(Object(ae.a)({},n),{},Object(we.a)({},a,r)))},l=e();return r.a.createElement("form",{className:l.root,noValidate:!0,autoComplete:"off"},r.a.createElement(T.a,{variant:"h2"},"Grid Properties"),r.a.createElement("div",{className:l.root},r.a.createElement(Me.a,{InputProps:{classes:{notchedOutline:l.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"tableName",label:"CityScope Project Name",defaultValue:n.tableName})),r.a.createElement("div",{className:l.root},r.a.createElement(Me.a,{InputProps:{classes:{notchedOutline:l.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"latitude",label:"Latitude",defaultValue:n.latitude,type:"number"}),r.a.createElement(Me.a,{InputProps:{classes:{notchedOutline:l.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"longitude",label:"Longitude",defaultValue:n.longitude,type:"number"}),r.a.createElement(Me.a,{InputProps:{classes:{notchedOutline:l.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"tz",label:"Time Zone (GMT)",defaultValue:n.tz,type:"number"})),r.a.createElement("div",{className:l.root},r.a.createElement(Ze,{mapCenter:[n.latitude,n.longitude]})),r.a.createElement("div",{className:l.root},r.a.createElement(Me.a,{onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"nrows",label:"Rows",defaultValue:n.nrows,type:"number",InputProps:{classes:{notchedOutline:l.notchedOutline},inputProps:{max:100,min:0}}}),r.a.createElement(Me.a,{onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"ncols",label:"Columns",defaultValue:n.ncols,type:"number",InputProps:{classes:{notchedOutline:l.notchedOutline},inputProps:{max:100,min:0}}}),r.a.createElement(Me.a,{onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"rotation",label:"Rotation (deg)",defaultValue:n.rotation,type:"number",InputProps:{classes:{notchedOutline:l.notchedOutline},inputProps:{max:360,min:0}}}),r.a.createElement(Me.a,{onChange:function(e){return i(e)},variant:"outlined",className:l.textField,id:"cellSize",label:"Cell Size (m^2)",defaultValue:n.cellSize,type:"number",InputProps:{classes:{notchedOutline:l.notchedOutline},inputProps:{max:1e3,min:0}}})),r.a.createElement("div",{className:l.root},r.a.createElement(Me.a,{InputProps:{classes:{notchedOutline:l.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",id:"projection",label:"Projection",defaultValue:n.projection,type:"string",helperText:"Default projection should work for most CityScope cases. Find specific projections at: https://epsg.io/"})),r.a.createElement("div",{className:l.root},r.a.createElement(We,{gridProps:n}),r.a.createElement(Ke,{gridProps:n})))}function tt(){return r.a.createElement(j.a,null,r.a.createElement(M.a,null,r.a.createElement(T.a,{variant:"h1"},"CityScope Grid Editor")),r.a.createElement(M.a,null,r.a.createElement(T.a,null,"This tool is for creating CityScope projects with virtual editable girds, types, and props, and deploy them to cityIO.")),r.a.createElement(M.a,null,r.a.createElement(et,null)),r.a.createElement(M.a,null,r.a.createElement(_e,null)))}var at=Object(m.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}}));function nt(){var e=at();return r.a.createElement(Z,{className:e.root,title:"Editor"},r.a.createElement(Q.a,{maxWidth:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne.a,{container:!0,spacing:5},r.a.createElement(Ne.a,{item:!0,xs:12,l:6,md:6,xl:4},r.a.createElement(C.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"}},r.a.createElement(I.a,null,r.a.createElement(tt,null)))),r.a.createElement(Ne.a,{item:!0,xs:12,l:6,md:6,xl:8},r.a.createElement(C.a,{elevation:15,style:{height:"85vh",width:"100%",position:"relative"}},r.a.createElement(I.a,null,r.a.createElement(Te,null))))))))}var rt=a(193),ot=a.n(rt),it=a(369),lt=a(44),ct=a(352),ut=function(e,t,a){var n=lt.cityIO.baseURL+e+"/meta/hashes";qe.a.get(n).then((function(n){var r,o=Object.keys(n.data).filter((function(e){return e.includes("scenarios")})).map((function(e){return parseInt(e.replace("scenarios",""))})),i=[],l=Object(ct.a)(o);try{for(l.s();!(r=l.n()).done;){var c=r.value;i.push(st(e,c))}}catch(u){l.e(u)}finally{l.f()}Promise.all(i).then((function(e){t(e.map((function(e){return{name:e.data.name,id:e.data.id}}))),a&&a(!1)})).catch((function(e){return console.log("error getting scenario names",e)}))})).catch((function(e){console.log("Error getting scenarios",e)}))},st=function(e,t){var a=lt.cityIO.baseURL+e+"/scenarios"+t+"/info";return qe.a.get(a)},mt=function(){var e=Object(it.a)(ot.a.mark((function e(t){var a;return ot.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qe.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();function pt(e){var t=e.tableName,a=Object(n.useState)(null),r=Object(O.a)(a,2),o=r[0],i=r[1],l=Object(n.useState)({}),c=Object(O.a)(l,2),u=c[0],s=c[1],m=lt.cityIO.baseURL+t,p=Object(ce.d)((function(e){return e.CITYIO})),d=Object(ce.c)();function f(){return h.apply(this,arguments)}function h(){return(h=Object(it.a)(ot.a.mark((function e(){var t;return ot.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(m+"/meta/id");case 2:t=e.sent,o!==t&&i(t),setTimeout(f,lt.cityIO.interval);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(it.a)(ot.a.mark((function e(){var a,n,r,o,i,l;return ot.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(m+"/meta/hashes");case 2:return a=e.sent,n=[],r=[],(o=lt.cityIO.cityIOmodules.map((function(e){return e.name}))).forEach((function(e){u[e]!==a[e]?(n.push(mt(m+"/"+e)),r.push(e)):n.push(null)})),d(Oe(r)),e.next=10,Promise.all(n);case 10:i=e.sent,s(a),(l=o.reduce((function(e,t,a){return i[a]?(console.log("updating ".concat(t)),Object(ae.a)(Object(ae.a)({},e),{},Object(we.a)({},t,i[a]))):e}),p)).tableName=t,d(ve(r)),d(de(l)),console.log("done updating from cityIO"),d(Ee(!0)),d(ge(!1));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e=setTimeout(f,lt.cityIO.interval);return console.log("reading cityIO every"+lt.cityIO.interval+"ms"),function(){return clearTimeout(e)}}),[]),Object(n.useEffect)((function(){o&&(d(ge(!0)),ut(t,(function(e){return d(be(e))})),function(){E.apply(this,arguments)}())}),[o]),null}for(var dt=a(776),ft=a(756),ht=a(775),Et=a(494),gt=a(741),bt=a(752),Ot=a(142),vt=Object.keys(lt.menu.toggles),St=[],yt=0;yt<vt.length;yt++)Object.values(lt.menu.toggles)[yt].showOnInit&&St.push(vt[yt]);var jt={MENU:St,CITYIO:{},SCENARIO_NAMES:[],MAP:{},LOADING_MODULES:[],SLIDERS:{time:[lt.map.layers.ABM.startSimHour,lt.map.layers.ABM.currentSimHour,lt.map.layers.ABM.endSimHour],speed:lt.map.layers.ABM.animationSpeed},ABM_MODE:"mode",ACCESS_TOGGLE:0,SELECTED_TYPE:null,READY:!1,LOADING:!1,ROW_EDIT:null,BASE_MAP_CENTER:{latCenter:null,lonCenter:null},TYPES_LIST:null,GRID_CREATED:null};function Ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CITYIO_DATA":return Object(ae.a)(Object(ae.a)({},e),{},{CITYIO:t.data});case"MENU_INTERACTION":return Object(ae.a)(Object(ae.a)({},e),{},{MENU:t.data});case"LISTEN_TO_MAP_EVENTS":return Object(ae.a)(Object(ae.a)({},e),{},{MAP:t.data});case"LISTEN_TO_ABM_SLIDERS":return Object(ae.a)(Object(ae.a)({},e),{},{SLIDERS:t.data});case"LISTEN_TO_ABM_MODE":return Object(ae.a)(Object(ae.a)({},e),{},{ABM_MODE:t.data});case"LISTEN_TO_ACCESS_TOGGLE":return Object(ae.a)(Object(ae.a)({},e),{},{ACCESS_TOGGLE:t.data});case"LISTEN_TO_EDIT_MENU":return Object(ae.a)(Object(ae.a)({},e),{},{SELECTED_TYPE:t.data});case"SET_READY_STATE":return Object(ae.a)(Object(ae.a)({},e),{},{READY:t.data});case"SET_LOADING_STATE":return Object(ae.a)(Object(ae.a)({},e),{},{LOADING:t.data});case"SET_SCENARIO_NAMES":return Object(ae.a)(Object(ae.a)({},e),{},{SCENARIO_NAMES:t.data});case"ADD_LOADING_MODULES":return Object(ae.a)(Object(ae.a)({},e),{},{LOADING_MODULES:Object(xe.a)(new Set([].concat(Object(xe.a)(e.LOADING_MODULES),Object(xe.a)(t.data))))});case"REMOVE_LOADING_MODULES":return Object(ae.a)(Object(ae.a)({},e),{},{LOADING_MODULES:e.LOADING_MODULES.filter((function(e){return!t.data.includes(e)}))});case"LISTEN_TO_ROW_EDIT":return Object(ae.a)(Object(ae.a)({},e),{},{ROW_EDIT:t.data});case"LISTEN_TO_TYPES_LIST":return Object(ae.a)(Object(ae.a)({},e),{},{TYPES_LIST:t.data});case"LISTEN_TO_GRID_CREATOR":return Object(ae.a)(Object(ae.a)({},e),{},{GRID_CREATED:t.data});case"LISTEN_TO_BASE_MAP_CENTER":return Object(ae.a)(Object(ae.a)({},e),{},{BASE_MAP_CENTER:t.data});default:return e}}var It=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Dt=Object(Ot.d)(Ct,It);function Tt(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}var xt=function(e){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/i.test(e)},At=function(e,t,a){var n=new Set(lt.cityIO.cityIOmodules.filter((function(e){return e.expectUpdate})).map((function(e){return e.name}))),r=new Set(Object.keys(Dt.getState().CITYIO)),o=Object(xe.a)(r).filter((function(e){return n.has(e)})),i={method:"post",url:"https://cityio.media.mit.edu/api/table/update/"+t+a,data:e,headers:{"Content-Type":"application/json",Accept:"application/json"}};qe()(i).then((function(e){"ok"===e.data.status&&Dt.dispatch(Oe(o))})).catch((function(e){console.log("ERROR:",e)}))},Rt=function(e,t,a,n,r){var o=t.height,i=t.color,l=t.name,c=function(e,t,a){var n=t,r=e.x-n/2,o=e.y-n/2;return a.current.pickObjects({x:r,y:o,width:n,height:n})}(e,n,r);c.forEach((function(e){var t=e.object.properties;t&&t.interactive&&(t.color=xt(i)?Tt(i):i,t.height=o,t.name=l)})),a(c)},Nt=a(66);function _t(e){var t=["#85C4C8","#C22E00","#1E96BE","#EC9370","#F6D18A"],a=Object(n.useState)(!1),o=Object(O.a)(a,2),i=o[0],l=o[1],c=function(){var a=[];return e.typeInfo.forEach((function(e,n){a.push({angle:e.proportion,label:JSON.stringify(e.use),color:t[n]})})),a}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt.g,{colorType:"literal",animation:!0,className:"donut-chart-example",innerRadius:15,radius:25,getLabel:function(e){return e.label},showLabels:!1,getAngle:function(e){return e.angle},data:c,onValueMouseOver:function(e){l(e)},onSeriesMouseOut:function(){return l(!1)},width:50,height:50,padAngle:.1},!1!==i&&r.a.createElement(Nt.e,{value:i},r.a.createElement("div",{style:{background:"rgba(0,0,0,0.8)",fontSize:10}},r.a.createElement(T.a,{variant:"caption",gutterBottom:!0},i.label)))))}var wt=Object(ce.b)((function(e){return{cityioData:e.CITYIO}}),null)((function(e){var t=r.a.useState(null),a=Object(O.a)(t,2),n=a[0],o=a[1],i=Object(ce.c)(),l=Object(ce.d)((function(e){return e.SELECTED_TYPE})),c=l?l.height:null,u=[{value:0,label:"min"},{value:100,label:"max"}],s=function(e){return"string"==typeof e?JSON.parse(e):e};return r.a.createElement(r.a.Fragment,null,function(t){var a=[];return Object.keys(t).forEach((function(m,p){var d=t[m].description?t[m].description:null,f=t[m].color,h=s(e.cityioData.GEOGRID.properties.types[m].LBCS),E=s(e.cityioData.GEOGRID.properties.types[m].NAICS);xt(f)&&(f=Tt(f));var g="rgb("+f[0]+","+f[1]+","+f[2]+")",b=n===m,O=!1;t[m].height&&(O=!0),a.push(r.a.createElement("div",{key:Math.random()},r.a.createElement(M.a,{alignItems:"flex-start",button:!0,variant:"raised",selected:b,onClick:function(e){return a=m,(n=t[m]).name=a,o(a),void i(he(n));var a,n}},r.a.createElement(ft.a,null,r.a.createElement(ht.a,{style:{backgroundColor:g,color:"black"}},m.charAt(0))),r.a.createElement(Et.a,{primary:m})),r.a.createElement(gt.a,{in:b},r.a.createElement(y.a,{spacing:1,p:1,m:1},r.a.createElement(C.a,{elevation:15},r.a.createElement(I.a,null,r.a.createElement(T.a,{variant:"h5"},"Type Information"),d&&r.a.createElement(T.a,{variant:"caption"},d),r.a.createElement(y.a,{spacing:1,p:1,m:1}),r.a.createElement(Ne.a,{container:!0,spacing:3},r.a.createElement(Ne.a,{item:!0,xs:6,l:6,md:6,xl:6,container:!0},h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"caption"},"LBCS"),r.a.createElement(_t,{typeInfo:h}))),r.a.createElement(Ne.a,{item:!0,xs:6,l:6,md:6,xl:6,container:!0},E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"caption"},"NAICS"),r.a.createElement(_t,{typeInfo:E}))),O&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne.a,{item:!0,xs:10,l:10,md:10,xl:10,container:!0},r.a.createElement(T.a,{gutterBottom:!0},"Set Height"),r.a.createElement(dt.a,{value:c,valueLabelDisplay:"auto",onChange:function(e,t){return i(he(Object(ae.a)(Object(ae.a)({},l),{},{height:t})))},getAriaLabel:function(e){return e.toString()},min:u[0].value,max:u[1].value,marks:u})))))))),r.a.createElement(bt.a,null)))})),r.a.createElement(j.a,null,a)}(e.cityioData.GEOGRID.properties.types))})),Mt=Object(m.a)({root:{width:"80%",marginLeft:28},subtitle1:{marginTop:12},subtitle2:{marginTop:12}});function Gt(e){var t=e.trips.tripsData,a=t.mode,n=t.profile;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"h6",gutterBottom:!0},"mode"===e.tripTypeValue?"Mode Choise":"Profiles "),r.a.createElement(Nt.c,{height:300,width:150,items:function(e){var t="mode"===e?a:n,r=[];for(var o in t)r.push({title:t[o].name,color:t[o].color});return r}(e.tripTypeValue)}))}var Lt=a(774),kt=a(496),Ft=a(490),Pt=a(414),Bt=[{value:0,label:"12AM"},{value:21600,label:"6AM"},{value:43200,label:"12PM"},{value:64800,label:"6PM"},{value:86400,label:"12AM"}];var Wt=function(e){var t=Mt(),a=Object(ce.d)((function(e){return e.SLIDERS})),n=Object(ce.c)(),o=r.a.useState("mode"),i=Object(O.a)(o,2),l=i[0],c=i[1];return r.a.createElement("div",{className:t.root},r.a.createElement(Pt.a,{component:"fieldset"},r.a.createElement(kt.a,{"aria-label":"tripType",name:"tripType",value:l,onChange:function(e){n({type:"LISTEN_TO_ABM_MODE",data:e.target.value}),c(e.target.value)}},r.a.createElement(Ft.a,{value:"mode",control:r.a.createElement(Lt.a,null),label:"Mode Choice"}),r.a.createElement(Ft.a,{value:"profile",control:r.a.createElement(Lt.a,null),label:"Profile"}))),r.a.createElement(Gt,{trips:e,tripTypeValue:l}),r.a.createElement(T.a,{className:t.subtitle1,variant:"subtitle2",id:"range-slider",gutterBottom:!0},"Simulation Range"),r.a.createElement(dt.a,{min:0,max:86400,marks:Bt,value:a.time,onChange:function(e,t){n(fe(Object(ae.a)(Object(ae.a)({},a),{},{time:t})))},valueLabelDisplay:"off","aria-labelledby":"range-slider"}),r.a.createElement(T.a,{className:t.subtitle2,variant:"subtitle2",id:"continuous-slider",gutterBottom:!0},"Simulation Speed"),r.a.createElement(dt.a,{min:0,max:100,value:a.speed,onChange:function(e,t){n(fe(Object(ae.a)(Object(ae.a)({},a),{},{speed:t})))},valueLabelDisplay:"auto","aria-labelledby":"continuous-slider"}))},zt=Object(m.a)({root:{width:"80%",marginLeft:28},subtitle1:{marginTop:12},subtitle2:{marginTop:12}});var Ut=function(){var e=zt(),t=Object(ce.d)((function(e){return e.SLIDERS})),a=Object(ce.c)();return r.a.createElement("div",{className:e.root},r.a.createElement(T.a,{className:e.subtitle1,variant:"subtitle2",id:"range-slider",gutterBottom:!0},"Time of day"),r.a.createElement(dt.a,{min:0,max:86400,marks:[{value:0,label:"12AM"},{value:21600,label:"6AM"},{value:43200,label:"12PM"},{value:64800,label:"6PM"},{value:86400,label:"12AM"}],value:t.time,onChange:function(e,n){a(fe(Object(ae.a)(Object(ae.a)({},t),{},{time:n})))},valueLabelDisplay:"off","aria-labelledby":"range-slider"}))},Vt=a(757),Jt=a(758);var Yt=function(e){var t=Object(ce.d)((function(e){return e.ACCESS_TOGGLE})),a=e.cityioData,n=a&&a.access&&a.access.properties?a.access.properties:[],o=Object(ce.c)(),i=lt.map.layers.heatmap.colors,l=i.length-1;return r.a.createElement(j.a,null,r.a.createElement(M.a,null,r.a.createElement(Nt.b,{width:500,startColor:"rgb("+i[0][0]+","+i[0][1]+","+i[0][2]+")",endColor:"rgb("+i[l][0]+","+i[l][1]+","+i[l][2]+")",startTitle:"No Access",endTitle:"Full Access"})),n.map((function(e,a){return r.a.createElement(M.a,{key:e},r.a.createElement(Et.a,{primary:e,style:{textTransform:"capitalize"}}),r.a.createElement(Vt.a,null,r.a.createElement(Jt.a,{edge:"end",checked:t===a,onChange:function(){o({type:"LISTEN_TO_ACCESS_TOGGLE",data:a})}})))})))};var qt=function(e){for(var t=e.handleToggle,a=Object(ce.d)((function(e){return{menuState:e.MENU,cityioData:e.CITYIO}})),n=a.menuState,o=a.cityioData,i=lt.menu.toggles,l=Object.keys(i),c=[],u=Object.keys(o),s=0;s<l.length;s++){var m=i[l[s]].requireModule,p=!!n.includes(l[s]);if(u.includes(m)||!1===m){var d=r.a.createElement("div",{key:l[s]},r.a.createElement(M.a,null,r.a.createElement(Jt.a,{edge:"start",onChange:t(l[s]),checked:p}),r.a.createElement(Et.a,{primary:i[l[s]].displayName})),"SHADOWS"===l[s]&&r.a.createElement(gt.a,{in:p},r.a.createElement(Ut,null)),"ABM"===l[s]&&r.a.createElement(gt.a,{in:p},r.a.createElement(Wt,{tripsData:o.ABM2.attr})),"ACCESS"===l[s]&&r.a.createElement(gt.a,{in:p,style:{marginLeft:24}},r.a.createElement(Yt,{cityioData:o})));c.push(d)}}return r.a.createElement(j.a,null,c)},Ht=a(746),Xt=a(751),Kt=a(749),Qt=a(750),$t=a(748);function Zt(e){var t=r.a.useState(!1),a=Object(O.a)(t,2),n=a[0],o=a[1],i=r.a.useState(""),l=Object(O.a)(i,2),c=l[0],u=l[1],s=Object(ce.c)(),m=e.tableName,p=e.toggleDrawer,d=function(){o(!1)},f=Object(ce.d)((function(e){return e.CITYIO})),h=Object(ce.d)((function(e){return e.SCENARIO_NAMES})),E=function(e){var t={GEOGRIDDATA:f.GEOGRIDDATA,info:{id:e,name:c}},a={method:"post",url:lt.cityIO.baseURL+"update/"+m+"/scenarios"+e,data:t,headers:{"Content-Type":"application/json",Accept:"application/json"}};qe()(a).then((function(e){console.log("Successfully saved grid data and network"),s(ge(!1)),p(),d()})).catch((function(e){console.log("%c"+e),console.log("ERROR:",e),d()}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{disabled:h.length>=10,variant:"outlined",color:"default",onClick:function(){o(!0)},startIcon:r.a.createElement(Ue.a,null)},"Save Scenario"),r.a.createElement(Ht.a,{open:n,onClose:d,"aria-labelledby":"form-dialog-title"},r.a.createElement(Xt.a,{id:"form-dialog-title"},"Save Scenario"),r.a.createElement(Kt.a,null,r.a.createElement(Qt.a,null,"Name:"),r.a.createElement(Me.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0,value:c,onChange:function(e){return u(e.target.value)}})),r.a.createElement($t.a,null,r.a.createElement(G.a,{onClick:d,color:"default"},"Cancel"),r.a.createElement(G.a,{onClick:function(){s(ge(!0)),function(){var e={method:"get",url:lt.cityIO.baseURL+m+"/meta/hashes",headers:{"Content-Type":"application/json",Accept:"application/json"}};qe()(e).then((function(e){var t=Object.keys(e.data).filter((function(e){return e.includes("scenarios")})).map((function(e){return parseInt(e.replace("scenarios",""))}));console.log("successfully got scenarios");var a=t.length?Math.max.apply(Math,Object(xe.a)(t))+1:0;E(a)})).catch((function(e){console.log("Error getting scenarios",e)}))}()},color:"default"},"Save"))))}var ea=a(563),ta=a.n(ea);var aa=function(e){var t=Object(ce.d)((function(e){return e.CITYIO})),a=Object(ce.d)((function(e){return e.SCENARIO_NAMES})),n=Object(ce.c)();return r.a.createElement(j.a,null,a.map((function(e){return r.a.createElement(M.a,{key:e.id},r.a.createElement(G.a,{style:{textTransform:"none"},onClick:function(){n(ge(!0)),function(e,a){var n={method:"get",url:lt.cityIO.baseURL+e+"/scenarios"+a,headers:{"Content-Type":"application/json",Accept:"application/json"}};qe()(n).then((function(e){var a=e.data.GEOGRIDDATA;At(a,t.tableName,"/GEOGRIDDATA")})).catch((function(e){console.log("ERROR:",e)}))}(t.tableName,e.id)}},r.a.createElement(T.a,{variant:"h6"},e.name)),r.a.createElement(G.a,{onClick:function(){n(ge(!0)),function(e,a){var r={method:"get",url:lt.cityIO.baseURL+"clear/"+e+"/scenarios"+a,headers:{"Content-Type":"application/json",Accept:"application/json"}};qe()(r).then((function(e){ut(t.tableName,(function(e){return n(be(e))}),(function(e){return n(ge(e))}))})).catch((function(e){console.log("ERROR:",e)}))}(t.tableName,e.id)}},r.a.createElement(ta.a,null)))})))};function na(e){var t=e.tableName;return r.a.createElement(j.a,null,r.a.createElement(M.a,null,r.a.createElement(Zt,{tableName:t})),r.a.createElement(M.a,null,r.a.createElement(bt.a,null)),r.a.createElement(M.a,null,r.a.createElement(aa,null)))}var ra=a(564),oa=a.n(ra),ia=a(565),la=a.n(ia);var ca=function(e){var t=e.tableName,a=Object(ce.d)((function(e){return e.MENU})),n=Object(ce.c)(),o=function(e){return function(){var t=a.indexOf(e),r=Object(xe.a)(a);-1===t?r.push(e):r.splice(t,1),n({type:"MENU_INTERACTION",data:r})}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null,r.a.createElement(M.a,null,r.a.createElement(T.a,{variant:"h2"},"Grid Edit")),r.a.createElement(M.a,null,r.a.createElement(G.a,{startIcon:a.includes("EDIT")?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue.a,null),"Send to cityIO"):r.a.createElement(r.a.Fragment,null,r.a.createElement(oa.a,null),"Edit Mode"),color:"default",onClick:o("EDIT")})),r.a.createElement(wt,null),r.a.createElement(M.a,null,r.a.createElement(T.a,{variant:"h2"},"Scenarios")),r.a.createElement(M.a,null,r.a.createElement(na,{tableName:t,handleToggle:o})),r.a.createElement(M.a,null,r.a.createElement(T.a,{variant:"h2"},"View Options")),r.a.createElement(M.a,null,r.a.createElement(G.a,{startIcon:r.a.createElement(r.a.Fragment,null,r.a.createElement(la.a,null),"Reset View"),color:"default",onClick:o("RESET_VIEW")}))),r.a.createElement(qt,{handleToggle:o}))},ua=a(566),sa=a.n(ua),ma=function(e){if(!e.mousePos||!e.hoveredCells)return null;var t=e.selectedType,a=e.hoveredCells.object.properties.interactive,n=e.mousePos,o=e.divSize,i=t.color;xt(i)&&(i=Tt(i));var l="rgb("+i[0]+","+i[1]+","+i[2]+")",c="rgba("+i[0]+","+i[1]+","+i[2]+",0.6)",u=n.clientX-o/2,s=n.clientY-o/2,m=a?t.name:"Not-interactive";return r.a.createElement("div",{style:{border:"2px solid",backgroundColor:e.mouseDown?c:"rgba(0,0,0,0)",borderColor:l,color:l,borderRadius:"15%",position:"fixed",zIndex:1,pointerEvents:"none",width:o,height:o,left:u,top:s}},r.a.createElement("div",{style:{position:"relative",left:o+10,fontSize:"0.8em"}},!a&&r.a.createElement(sa.a,null),m,":"))},pa=function(e){if(!e.mousePos)return null;var t=e.mousePos;return r.a.createElement("div",{style:{borderRadius:"10%",position:"fixed",pointerEvents:"none",backgroundColor:"rgba(0,0,0,0.5)",padding:"1vw",color:"rgba(255,255,255,0.9)",zIndex:1,left:t.clientX,top:t.clientY,fontFamily:"monospace",fontSize:"0.65em",fontWeight:500}},r.a.createElement("p",null,"Type:",e.hoveredObj.object.properties.name),r.a.createElement("p",null,"Floors:",e.hoveredObj.object.properties.height),r.a.createElement("p",null,"ID:",e.hoveredObj.object.properties.id))};function da(e){var t=e.editOn,a=e.mousePos,n=e.selectedType,o=e.pickingRadius,i=e.mouseDown,l=e.hoveredObj;return t?n&&r.a.createElement(ma,{mousePos:a,selectedType:n,divSize:o,mouseDown:i,hoveredCells:l}):l&&r.a.createElement(pa,{mousePos:a,hoveredObj:l})}var fa=function(e){Object(oe.a)(a,e);var t=Object(ie.a)(a);function a(e){var n;return Object(ne.a)(this,a),(n=t.call(this,e)).animationFrame=null,n}return Object(re.a)(a,[{key:"componentWillUnmount",value:function(){this.animationFrame&&window.cancelAnimationFrame(this.animationFrame)}},{key:"componentDidMount",value:function(){this._animate()}},{key:"_animate",value:function(){var e=this.props,t=e.toggles,a=t.rotateOn,n=t.ABMOn,r=e.state,o=r.viewState,i=r.sliders,l=e.updaters,c=l.listenToSlidersEvents,u=l.sunEffects,s=l.setViewState,m=e.dispatch;if(a){var p=o.bearing?o.bearing:0;p<360?p+=.05:p=0,s(Object(ae.a)(Object(ae.a)({},o),{},{bearing:p}))}if(n){var d=i.time[1],f=i.speed,h=i.time[0],E=i.time[2],g=parseInt(d)+parseInt(f);(d<h||d>E)&&(g=h),m(c(Object(ae.a)(Object(ae.a)({},i),{},{time:[i.time[0],g,i.time[2]]}))),u&&u.updateSunDirection(g)}this.animationFrame=window.requestAnimationFrame(this._animate.bind(this))}},{key:"render",value:function(){return null}}]),a}(n.Component),ha=a(726),Ea=a(543),ga=a(264),ba=new Date;ba.setHours(0,0,0,0);var Oa=function(e,t){var a=ba.getTime()+1e3*e,n=new Date(a);t.current[0].directionalLights[0].timestamp=Date.UTC(n.getFullYear(),n.getMonth(),n.getDay(),n.getHours(),n.getMinutes(),n.getSeconds())},va=a(770);function Sa(e){var t=e.data,a=e.accessToggle;return new va.a({id:"ACCESS",colorRange:lt.map.layers.heatmap.colors,radiusPixels:200,opacity:.5,threshold:.5,data:t,getPosition:function(e){return e.coordinates},getWeight:function(e){return e.values[a]},updateTriggers:{getWeight:[a]}})}var ya=a(370);function ja(e){var t=e.data,a=e.cityioData,n=e.ABMmode;return new ya.a({id:"AGGREGATED_TRIPS",_shadow:!1,data:t,getPath:function(e){var t=Math.random()<.5?5e-5*Math.random():-5e-5*Math.random();for(var a in e.path)e.path[a][0]=e.path[a][0]+t,e.path[a][1]=e.path[a][1]+t,e.path[a][2]=2*e.mode[0];return e.path},getColor:function(e){return Tt(a.ABM2.attr[n][e[n]].color)},opacity:.2,getWidth:1.5,updateTriggers:{getColor:n},transitions:{getColor:500}})}var Ca=a(768);function Ia(e){var t,a=e.data,n=e.cityioData,r=e.ABMmode,o=e.zoomLevel,i=e.sliders;return new Ca.a({id:"ABM",data:a,getPath:function(e){return e.path},getTimestamps:function(e){return e.timestamps},getColor:function(e){return Tt(n.ABM2.attr[r][e[r]].color)},getWidth:1,widthScale:(t=o,t>15&&t<25?3:t<15&&t>10?12:30),opacity:.8,rounded:!0,trailLength:500,currentTime:i.time[1],updateTriggers:{getColor:r},transitions:{getColor:500}})}function Da(e){var t=e.data,a=e.editOn,n=e.state,r=n.selectedType,o=n.keyDownState,i=n.selectedCellsState,l=n.pickingRadius,c=e.updaters,u=c.setSelectedCellsState,s=c.setDraggingWhileEditing,m=c.setHoveredObj,p=e.deckGL;return new me.a({id:"GRID",data:t,pickable:!0,extruded:!0,wireframe:!0,lineWidthScale:1,lineWidthMinPixels:2,getElevation:function(e){return e.properties.height},getFillColor:function(e){return e.properties.color},onClick:function(e){r&&a&&"Shift"!==o&&Rt(e,r,u,l,p)},onDrag:function(e){r&&a&&"Shift"!==o&&Rt(e,r,u,l,p)},onDragStart:function(){r&&a&&"Shift"!==o&&s(!0)},onHover:function(e){e.object&&m(e)},onDragEnd:function(){s(!1)},updateTriggers:{getFillColor:i,getElevation:i},transitions:{getFillColor:500,getElevation:500}})}function Ta(){var e=Object(n.useState)(!1),t=Object(O.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(null),l=Object(O.a)(i,2),c=l[0],u=l[1],s=Object(n.useState)(lt.map.initialViewState),m=Object(O.a)(s,2),p=m[0],d=m[1],f=Object(n.useState)(null),h=Object(O.a)(f,2),E=h[0],g=h[1],b=Object(n.useState)(null),v=Object(O.a)(b,2),S=v[0],y=v[1],j=Object(n.useState)(null),C=Object(O.a)(j,2),I=C[0],D=C[1],T=Object(n.useState)(null),x=Object(O.a)(T,2),A=x[0],R=x[1],N=Object(n.useState)(null),_=Object(O.a)(N,2),w=_[0],M=_[1],G=Object(n.useState)(null),L=Object(O.a)(G,2),k=L[0],F=L[1],P=Object(n.useState)({}),B=Object(O.a)(P,2),W=B[0],z=B[1],U=Object(n.useState)(!1),V=Object(O.a)(U,2),J=V[0],Y=V[1],q=Object(n.useRef)(),H=Object(n.useRef)(),X=Object(ce.c)(),K=Object(ce.d)((function(e){return[e.CITYIO,e.SLIDERS,e.MENU,e.ACCESS_TOGGLE,e.SELECTED_TYPE,e.ABM_MODE]})),Q=Object(O.a)(K,6),$=Q[0],Z=Q[1],ee=Q[2],te=Q[3],ne=Q[4],re=Q[5],oe=ee.includes("ABM"),ie=ee.includes("ROTATE"),le=ee.includes("SHADOWS"),me=ee.includes("EDIT"),pe=ee.includes("RESET_VIEW");Object(n.useEffect)((function(){he(),function(e,t){t.tz&&ba.setHours(t.tz,0,0,0);var a=new ha.a({color:[255,255,255],intensity:.85}),n=new Ea.a({timestamp:0,color:[255,255,255],intensity:1,_shadow:!0}),r=new ga.a({ambientLight:a,dirLight:n});r.shadowColor=[0,0,0,.5],e.current=[r]}(q,$.GEOGRID.properties.header),de(),Y(!0)}),[]),Object(n.useEffect)((function(){J&&Oa(Z.time[1],q)}),[Z.time]),Object(n.useEffect)((function(){if(J){var e=le?[0,0,0,.5]:[0,0,0,0];q.current[0].shadowColor=e}}),[le]),Object(n.useEffect)((function(){F(function(e){var t=e.GEOGRID;if(e.GEOGRIDDATA&&e.GEOGRIDDATA.length===e.GEOGRID.features.length)for(var a=e.GEOGRIDDATA,n=0;n<t.features.length;n++)t.features[n].properties=a[n],t.features[n].properties.id=n;return JSON.parse(JSON.stringify(t))}($)),$.access&&M(function(e){for(var t=e.access,a=t.features.map((function(e){return e.geometry.coordinates})),n=t.features.map((function(e){return e.properties})),r=[],o=0;o<a.length;o++)r.push({coordinates:a[o],values:n[o]});return r}($)),$.ABM2&&z($.ABM2)}),[$]),Object(n.useEffect)((function(){if(J&&!me){for(var e=[],t=0;t<k.features.length;t++)e[t]=k.features[t].properties;At(e,$.tableName,"/GEOGRIDDATA")}}),[me]),Object(n.useEffect)((function(){J&&de()}),[pe]);var de=function(){var e=$.GEOGRID.properties.header;d(Object(ae.a)(Object(ae.a)({},p),{},{longitude:e.longitude,latitude:e.latitude,zoom:15,pitch:0,bearing:360-e.rotation,orthographic:!0}))},he=function(){document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))},Ee={ABM:Ia({data:W.trips,cityioData:$,ABMmode:re,zoomLevel:p.zoom,sliders:Z}),AGGREGATED_TRIPS:ja({data:W.trips,cityioData:$,ABMmode:re}),GRID:Da({data:k,editOn:ee.includes("EDIT"),state:{selectedType:ne,keyDownState:E,selectedCellsState:c,pickingRadius:40},updaters:{setSelectedCellsState:u,setDraggingWhileEditing:o,setHoveredObj:R},deckGL:H}),ACCESS:Sa({data:w,accessToggle:te})},ge=["ABM","AGGREGATED_TRIPS","GRID","ACCESS"];return r.a.createElement("div",{className:"baseMap",onKeyDown:function(e){g(e.nativeEvent.key)},onKeyUp:function(){return g(null)},onMouseMove:function(e){return y(e.nativeEvent)},onMouseUp:function(){return D(!1)},onMouseDown:function(){return D(!0)}},r.a.createElement(da,{editOn:me,mousePos:S,selectedType:ne,pickingRadius:40,mouseDown:I,hoveredObj:A}),r.a.createElement(fa,{toggles:{ABMOn:oe,rotateOn:ie},state:{sliders:Z,viewState:p},updaters:{listenToSlidersEvents:fe,updateSunDirection:Oa,setViewState:d},dispatch:X}),r.a.createElement(se.a,{ref:H,viewState:p,onViewStateChange:function(e){var t=e.viewState;d(t)},layers:function(){var e,t=[],a=Object(ct.a)(ge);try{for(a.s();!(e=a.n()).done;){var n=e.value;ee.includes(n)&&t.push(Ee[n])}}catch(r){a.e(r)}finally{a.f()}return t}(),effects:q.current,controller:{touchZoom:!0,touchRotate:!0,dragPan:!a,dragRotate:!a,keyboard:!1}},r.a.createElement(ue.a,{asyncRender:!1,dragRotate:!0,reuseMaps:!0,mapboxApiAccessToken:"pk.eyJ1IjoicmVsbm94IiwiYSI6ImNqd2VwOTNtYjExaHkzeXBzYm1xc3E3dzQifQ.X8r8nj4-baZXSsFgctQMsg",mapStyle:lt.map.mapStyle.sat,preventStyleDiffing:!0})))}var xa=a(493),Aa=function(){var e=Object(ce.d)((function(e){return[e.LOADING_MODULES]})),t=Object(O.a)(e,1)[0];return r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement(y.a,{position:"fixed",bottom:50*t,right:"2vw",width:"10vw",zIndex:"9999",margin:"0",key:e},r.a.createElement(xa.a,{color:"secondary"}),r.a.createElement(T.a,{variant:"h6",color:"primary",style:{marginRight:"10px"}},e))})))},Ra=function(){return r.a.createElement(y.a,{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},r.a.createElement(Q.a,{maxWidth:"sm"},r.a.createElement(T.a,{align:"center",color:"textPrimary",variant:"h1"},"CityScopeJS"),r.a.createElement(T.a,{align:"center",color:"textPrimary",variant:"h5"},"Enter your CityScopeJS project name in the search bar:"),r.a.createElement(T.a,{align:"center",variant:"h5",color:"textSecondary"},"(this page URL)/CS_CityScopeJS/?cityscope=projectName")))},Na=(a(408),a(708),["#ff5278","#660016"]);function _a(e){var t=Object(n.useState)(null),a=Object(O.a)(t,2),o=a[0],i=a[1];return Object(n.useEffect)((function(){if(e&&e.cityioData&&e.cityioData.indicators&&e.cityioData.indicators.length>0){var t=function(e){for(var t={},a={},n=[],r=0;r<e.length;r++)"radar"===e[r].viz_type&&(t[e[r].name]=[e[r].value],a[e[r].name]=[e[r].ref_value],e[r].domain=[0,1],n.push(e[r]));return{radarData:[t,a],domains:n}}(e.cityioData.indicators);i(t)}}),[e]),r.a.createElement("div",null,o&&o.domains&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt.f,{className:"Radar blur",animation:!0,data:o.radarData,domains:o.domains,colorRange:Na,style:{polygons:{fillOpacity:.2,strokeWidth:2},axes:{text:{opacity:0,fontWeight:700,fill:"white",fontFamily:"Roboto Mono"},strokeWidth:0},labels:{fontFamily:"Roboto Mono",textAnchor:"middle",fontSize:10,fill:"white"}},margin:{left:50,top:50,bottom:50,right:50},width:300,height:300},r.a.createElement(Nt.a,{style:{fill:"white",fillOpacity:.1,backgroundColor:"#FFF",opacity:.5,stroke:"white",width:.1},tickValues:Object(xe.a)(new Array(11)).map((function(e,t){return t/10-1}))})),r.a.createElement(Nt.c,{items:["Design","Reference"],colors:Na,style:{fontFamily:"Roboto Mono"}})))}function wa(e){var t=Object(n.useState)(null),a=Object(O.a)(t,2),o=a[0],i=a[1],l=Object(n.useState)(null),c=Object(O.a)(l,2),u=c[0],s=c[1];Object(n.useEffect)((function(){if(e&&e.cityioData&&e.cityioData.indicators&&e.cityioData.indicators.length>0){var t=m(e.cityioData.indicators);i(t.barChartData)}}),[e]);var m=function(e){for(var t=[],a=0;a<e.length;a++)"bar"===e[a].viz_type&&t.push({x:e[a].name,y:e[a].value});return{barChartData:t}};return r.a.createElement(r.a.Fragment,null,o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{flexDirection:"column"},r.a.createElement(y.a,{alignContent:"center",p:3},r.a.createElement(Nt.d,{opacity:.2,xType:"ordinal",width:250,height:250,stackBy:"y",yDomain:[0,1]},r.a.createElement(Nt.i,{style:{text:{fill:"#FFF",fontFamily:"Roboto Mono"}},tickLabelAngle:90}),r.a.createElement(Nt.j,{style:{text:{fill:"#FFF"}}}),r.a.createElement(Nt.h,{animation:!0,onValueMouseOver:function(e){s(e)},data:o}))),r.a.createElement(y.a,{alignContent:"center"},u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"caption",gutterBottom:!0},u.x),r.a.createElement(y.a,{m:3}),r.a.createElement(T.a,{gutterBottom:!0},u.y))))))}function Ma(e){var t=Object(n.useState)(!1),a=Object(O.a)(t,2),o=a[0],i=a[1],l=Object(n.useState)(null),c=Object(O.a)(l,2),u=c[0],s=c[1];return Object(n.useEffect)((function(){var t=function(){var t=e.cityioData.GEOGRID.properties.header.cellSize,a=e.cityioData.GEOGRIDDATA,n={};a.forEach((function(e){var a=e.name;if("None"!==e.name)if(n.hasOwnProperty(a)){n[a].count=n[a].count+1;var r=e.height<1?1:e.height;n[a].area=n[a].area+r*t}else n[a]={},n[a].area=0,n[a].count=0,n[a].name=a,n[a].color=function(e,t,a){function n(e){var t=e.toString(16);return 1===t.length?"0"+t:t}return"#"+n(e)+n(t)+n(a)}(e.color[0],e.color[1],e.color[2])}));var r=[];for(var o in n)r.push(n[o]);return{children:r,color:1}}();s(t)}),[e]),r.a.createElement(j.a,null,u&&u.children&&r.a.createElement(M.a,{alignItems:"center"},r.a.createElement(Nt.g,{colorType:"literal",animation:!0,className:"donut-chart-example",innerRadius:75,radius:125,getLabel:function(e){return e.name},labelsRadiusMultiplier:.95,labelsStyle:{textAnchor:"middle",font:"sans-serif",fontSize:11,fill:"#FFF",textShadow:"2px 2px 2px #000",fontFamily:"Roboto Mono"},showLabels:!0,getAngle:function(e){return e.area},data:u.children,onValueMouseOver:function(e){return i(e)},onSeriesMouseOut:function(){return i(!1)},width:250,height:250,padAngle:.01},!1!==o&&r.a.createElement(Nt.e,{value:o},r.a.createElement("div",{style:{background:"rgba(0,0,0,0.8)",fontSize:14}},r.a.createElement(T.a,{variant:"caption",gutterBottom:!0},"Area: ",o.area," sqm"))))),o.name&&r.a.createElement(j.a,null,r.a.createElement(M.a,null,r.a.createElement(T.a,{variant:"caption"},o.name)),r.a.createElement(M.a,null,r.a.createElement(T.a,null,o.area," sqm"))))}var Ga=function(e){return r.a.createElement(r.a.Fragment,null,e.cityIOdata&&r.a.createElement(j.a,null,r.a.createElement(M.a,{alignItems:"center"},r.a.createElement(Ma,{cityioData:e.cityIOdata})),r.a.createElement(bt.a,null),r.a.createElement(M.a,null,r.a.createElement(_a,{cityioData:e.cityIOdata})),r.a.createElement(bt.a,null),r.a.createElement(M.a,null,r.a.createElement(wa,{cityioData:e.cityIOdata}))))},La=Object(m.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}}));function ka(){var e=La(),t=Object(n.useState)(null),a=Object(O.a)(t,2),o=a[0],i=a[1];Object(n.useEffect)((function(){var e=window.location.toString(),t="cityscope=",a=e.substring(e.indexOf(t)+t.length);-1!==e.indexOf(t)&&a.length>0&&i(a)}),[]);var l=Object(ce.d)((function(e){return e.READY})),c=Object(ce.d)((function(e){return e.CITYIO}));return r.a.createElement(Z,{className:e.root,title:"CitySCopeJS"},r.a.createElement(Q.a,{maxWidth:!1},!l&&r.a.createElement(Ra,null),o&&r.a.createElement(pt,{tableName:o}),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne.a,{container:!0,spacing:5},r.a.createElement(Ne.a,{item:!0,xs:6,l:3,md:3,xl:2,container:!0},r.a.createElement(Ne.a,{item:!0,container:!0,direction:"column",spacing:2},r.a.createElement(Ne.a,{item:!0,xs:12,l:12,md:12,xl:12},r.a.createElement(C.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"}},r.a.createElement(I.a,null,r.a.createElement(ca,{tableName:o})))))),r.a.createElement(Ne.a,{item:!0,xs:6,l:6,md:6,xl:8},r.a.createElement(C.a,{elevation:15,style:{height:"85vh",width:"100%",position:"relative"}},r.a.createElement(Ta,null))),r.a.createElement(Ne.a,{item:!0,xs:6,l:3,md:3,xl:2},r.a.createElement(C.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"}},r.a.createElement(Ga,{cityIOdata:c}))))),r.a.createElement(Aa,null)))}function Fa(){var e=Object(n.useState)({author:"",branch:"",date:"",sha:"",link:""}),t=Object(O.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)((function(){fetch("https://api.github.com/repos/CityScope/CS_cityscopeJS/branches/master").then((function(e){e.json().then((function(e){o({author:e.commit.commit.author.name,date:e.commit.commit.author.date,sha:e.commit.sha})}))})).catch((function(e){console.log(e)}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{color:"textSecondary",variant:"caption"},r.a.createElement("h2",null,"CityScopeJS Development Tracking"),r.a.createElement("h4",null,"Last Commit"),r.a.createElement("div",null,"Author: ",JSON.parse(JSON.stringify(a.author))),r.a.createElement("div",null,"Date: ",JSON.parse(JSON.stringify(a.date))),r.a.createElement("div",null,"Hash: ",JSON.parse(JSON.stringify(a.sha)))))}var Pa=Object(m.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)},gridCell:{textAlign:"center"},divider:{margin:e.spacing(3)}}}));function Ba(){var e=Pa();return r.a.createElement(Z,{className:e.root,title:"Home"},r.a.createElement(Q.a,{maxWidth:"sm",className:e.content},r.a.createElement(T.a,{color:"textPrimary",variant:"h1"},"CityScopeJS"),r.a.createElement(bt.a,{className:e.divider,light:!0}),r.a.createElement(T.a,{color:"textPrimary",variant:"h5"},"CityScopeJS is a unified front-end for MIT CityScope project, an open-source urban modeling and simulation platform. CityScopeJS allows users to examine different urban-design alternatives, and observe their impact through multiple layers of urban analytics modules, such as economy, traffic and ABM simulation, urban access, storm-water, noise and more."),r.a.createElement(bt.a,{className:e.divider,light:!0}),r.a.createElement(Ne.a,{container:!0,spacing:2},r.a.createElement(Ne.a,{item:!0,xs:12,l:6,md:6,xl:6},r.a.createElement(T.a,{color:"textPrimary",variant:"h6",gutterBottom:!0},"CityScopeJS is an open-source project, developed by MIT, the CityScope Network, and contributers from all over the world. Join us!")),r.a.createElement(Ne.a,{item:!0,xs:12,l:6,md:6,xl:6,className:e.gridCell},r.a.createElement(D.a,{href:"http://github.com/CityScope/CS_cityscopeJS/",color:"default"},r.a.createElement(S.a,null)))),r.a.createElement(bt.a,{className:e.divider,light:!0}),r.a.createElement(y.a,{flex:1},r.a.createElement(Fa,null))))}var Wa=[{path:"/",element:r.a.createElement(K,null),children:[{path:"/",element:r.a.createElement(Ba,null)},{path:"/home",element:r.a.createElement(Ba,null)},{path:"/cityscopejs",element:r.a.createElement(ka,null)},{path:"/editor",element:r.a.createElement(nt,null)},{path:"*",element:r.a.createElement(u.a,{to:"/404"})},{path:"404",element:r.a.createElement(te,null)}]}],za=function(){var e=Object(u.i)(Wa);return r.a.createElement(s.a,{theme:b},r.a.createElement(f,null),e)},Ua=function(e){var t=e.children,a=e.store;return r.a.createElement(ce.a,{store:a},t)},Va=Object(c.b)();i.a.render(r.a.createElement(Ua,{store:Dt},r.a.createElement(l.a,{history:Va,basename:"https://cityscope.media.mit.edu/CS_cityscopeJS"},r.a.createElement(za,null))),document.getElementById("root"))}},[[603,1,2]]]);
//# sourceMappingURL=main.c41e69d4.chunk.js.map